# 📈 AI 주식 뉴스 분석기 (AI Stock News Analyzer)

LangGraph와 Text-to-SQL을 활용하여 뉴스와 재무 데이터를 종합적으로 분석하고, 투자 인사이트를 제공하는 지능형 분석 시스템

## 📌 1. 프로젝트 개요 (Overview)

본 프로젝트는 최신 주식 뉴스를 단순히 전달하는 것을 넘어, AI가 해당 뉴스를 다각적이고 깊이 있게 분석하여 투자 판단에 실질적인 도움을 주는 것을 목표로 합니다.

가장 큰 특징은 LangGraph를 통해 "DB 최신 뉴스 조회 → 재무 데이터 확인 → 종합 분석"이라는 명시적인 작업 흐름을 구축하여, 일반적인 AI Agent의 예측 불가능성을 제어하고 분석 과정의 신뢰성을 확보했다는 점입니다. 또한, Text-to-SQL 기술을 도입하여 AI가 직접 데이터베이스와 대화하며 필요한 정보를 추출하도록 설계되었습니다.

## ✨ 2. 주요 특징 (Key Features)

제어 가능한 AI 워크플로우: LangGraph를 사용하여 분석의 각 단계를 명확하게 정의하고, 안정적이고 예측 가능한 결과 도출

하이브리드 데이터 소싱: 내부 DB의 정형 데이터(과거 뉴스, 재무 정보)를 우선적으로 활용하고, 부족한 정보는 실시간 웹 검색으로 보충

지능형 DB 조회: AI가 자연어 질문을 SQL 쿼리로 자동 변환하여 필요한 데이터를 직접 DB에서 추출 (Text-to-SQL)

심층 컨텍스트 분석: 최신 뉴스 1건(원문)과 이전 뉴스(요약), 그리고 yfinance를 통해 수집한 최신 4분기 재무제표를 종합하여 분석의 깊이를 더함

모듈화된 설계: 기능별(도구, 그래프, DB 모델 등)로 코드가 분리되어 있어 유지보수 및 기능 확장이 용이

## ⚙️ 3. 시스템 아키텍처 (System Architecture)

본 시스템은 LangGraph로 설계된 다음과 같은 순서로 작동합니다.

[시작] 새로운 뉴스 조회 및 DB 업데이트 (crawl_and_update_db_node): 크롤링을 통해 최신 뉴스 목록을 가져옵니다. DB의 뉴스를 조회하고
새로운 뉴스는 상세정보를 수집, DB에 저장합니다.

→ 재무제표 조회 (fetch_financials): yfinance를 통해 분석 대상의 최신 4분기 재무제표(재무상태표, 손익계산서, 현금흐름표)를 가져옵니다.

→ DB 뉴스 확인 및 요약 (fetch_db_news): 내부 데이터베이스에서 최신 뉴스 3건을 조회합니다. 가장 최신 뉴스는 원문을, 이전 2건은 AI를 통해 요약합니다.

→ 최종 보고서 생성 (generate_answer): 모든 수집된 정보(뉴스 원문/요약, 재무제표, 웹 검색 결과)를 종합하여 최종 분석 보고서를 생성합니다.

→ [종료]

## 📂 4. 폴더 구조 (Folder Structure)

```
ai_stock_analyzer/
│
├── .env # (직접 생성) API 키, DB 정보 등 환경 변수
├── .gitignore
├── README.md
├── requirements.txt
├── main.py # 🚀 전체 워크플로우 실행 파일
│
├── config/ # 설정 폴더
│ ├── settings.py
│ └── logging_config.py
│
├── stock_analyzer/ # 핵심 소스코드 패키지
│ ├── database.py # DB 연결 및 초기화
│ ├── models.py # SQLAlchemy DB 테이블 모델
│ │
| ├── service # 뉴스의 크롤링, db 패키지
| | └──news_service.py
| |
│ ├── graph/ # LangGraph 워크플로우 패키지
│ │ ├── state.py
│ │ ├── nodes.py
│ │ └── builder.py
│ │
│ └── tools/ # AI가 사용하는 도구 패키지
│ ├── database_tools.py
│ └── financial_tools.py
│
└── logs/ # 로그 파일 저장 폴더
```

## 🛠️ 5. 기술 스택 (Tech Stack)

언어: Python 3.x

AI 프레임워크: LangChain, LangGraph

LLM: OpenAI GPT-4.1, OpenAI GPT-4.1-mini

데이터베이스: SQLAlchemy, MySQL

금융 데이터: yfinance

## 🚀 6. 설치 및 실행 방법 (Setup & Run)

1. 프로젝트 복제
   ```
   git clone https://github.com/your-username/ai_stock_analyzer.git
   cd ai_stock_analyzer
   ```
2. 가상환경 생성 및 활성화
   ```
   python -m venv venv
   ```
   ### Windows
   ```
   venv\Scripts\activate
   ```
   ### macOS / Linux
   ```
   source venv/bin/activate
   ```
3. 필요 라이브러리 설치
   ```
   pip install -r requirements.txt
   ```
4. 환경 변수 설정
   프로젝트 루트 디렉토리에 .env 파일을 생성하고 아래 내용을 채워주세요.

# .env

## --- API KEYS ---

```
OPENAI_API_KEY="sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
```

## --- DATABASE CONFIG ---

```
DB_TYPE="mysql"
DB_NAME="news_analysis"
```

5. 실행
   아래 명령어를 실행하면 DB 테이블이 자동으로 생성되고, main.py에 설정된 질문으로 분석이 시작됩니다.

```
python main.py
```

콘솔과 logs/app.log 파일에서 실행 과정을 확인할 수 있으며, 최종 분석 결과는 터미널에 출력됩니다.

## 🔮 7. 향후 개선 방향 (Future Improvements)

웹 대시보드 개발: 분석 결과를 시각적으로 보여주는 웹 인터페이스 구축 (Streamlit, FastAPI 등)

분석 모델 고도화: 예측 정확도를 실제 주가와 비교하여 백테스팅하고, 프롬프트와 그래프 로직을 지속적으로 개선

다중 종목 분석: 여러 주식 종목을 동시에 또는 주기적으로 분석하는 스케줄링 기능 추가 (APScheduler, Celery 등)

수집기 프로젝트 분리: 데이터 수집 파이프라인을 별도의 프로젝트로 분리하여 시스템 안정성 및 확장성 확보

## 📝 8. 변경 이력 (Changelog)

### 2024-07-29

- **초기 버전 릴리즈**: LangGraph 기반 AI 주식 뉴스 분석기 프로젝트 공개

### 2024-07-30

- **뉴스 크롤링 및 DB 저장 노드 추가**:
  - `fetch_latest_news` 노드 추가: 웹에서 최신 뉴스를 크롤링합니다.
  - `filter_and_save_news` 노드 추가: 크롤링된 뉴스 중 DB에 없는 뉴스를 필터링하여 저장합니다.
  - LangGraph 워크플로우 시작 노드 변경: `fetch_financials` 대신 `fetch_latest_news`로 시작하도록 수정.
  - 전체 워크플로우: `fetch_latest_news` → `filter_and_save_news` → `fetch_financials` → `fetch_db_news` → `generate_answer`

# 주식 분석 결과

## Apple Inc. (AAPL) 심층 분석 보고서

(2024년 9월 결산 기준)

---

### 1. 최신 뉴스 및 사업 동향

#### 1) 최신 뉴스 요약

- **3분기 실적 발표**: Apple은 최근 3분기 실적을 발표하였으나, 제공된 뉴스 원문에는 구체적인 수치나 실적 내용이 누락되어 있습니다.
- **AppleCare One 출시**: 다양한 보장 서비스를 하나의 플랜으로 통합한 AppleCare One을 출시, 서비스 부문 강화 및 고객 락인 효과 기대.
- **사우디아라비아 온라인 스토어 개설**: 중동 시장 진출 확대, 글로벌 매출 다변화 전략 지속.

#### 2) 해석

Apple은 하드웨어 중심에서 서비스·구독 모델로의 전환을 가속화하고 있습니다. 신흥시장 진출과 서비스 통합은 중장기 성장 동력으로 작용할 전망입니다.

---

### 2. 재무 분석

#### 1) 재무상태표(2021~2024)

- **총자산**: 2024년 9월 30일 기준 3,649.8억 달러로 3년간 안정적 유지(2021년 3,510.0억 → 2024년 3,649.8억).
- **자기자본**: 569.5억 달러로 3년 전 대비 감소(2021년 630.9억 → 2024년 569.5억).
- **부채비율**: 총부채 3,080.3억 달러, 자기자본 대비 약 541%로 매우 높은 수준.
- **순부채**: 766.9억 달러로 2022년 이후 감소세(2022년 964.2억 → 2024년 766.9억).
- **자사주 매입**: 보통주 수 지속 감소(2021년 164.3억 → 2024년 151.2억), 공격적 자사주 매입 정책 지속.

#### 2) 손익계산서(2021~2024)

- **매출액**: 2024년 3,910.4억 달러(2021년 3,658.2억 → 2024년 3,910.4억), 최근 3년간 정체 혹은 소폭 성장.
- **영업이익**: 2024년 1,232.2억 달러, 영업이익률 약 31.5%로 매우 높은 수익성 유지.
- **순이익**: 2024년 937.4억 달러, 3년간 큰 변동 없이 안정적.
- **EPS(희석)**: 2024년 6.08달러, 3년간 소폭 증가(2021년 5.61달러 → 2024년 6.08달러).

#### 3) 현금흐름표(2021~2024)

- **영업현금흐름**: 2024년 1,182.5억 달러, 꾸준한 현금 창출력.
- **잉여현금흐름(FCF)**: 2024년 1,088.1억 달러, 2022년 대비 소폭 감소했으나 여전히 업계 최고 수준.
- **자본환원**: 2024년 자사주 매입 949.5억 달러, 배당 152.3억 달러.
- **부채관리**: 신규 부채 발행 없이 기존 부채 상환(2024년 신규 발행 0, 상환 99.6억 달러).

---

### 3. 투자 포인트 및 리스크

#### 1) 투자 포인트

- **서비스 부문 성장**: AppleCare One 등 구독형 서비스 확대, 하드웨어 의존도 완화.
- **신흥시장 진출**: 사우디아라비아 등 신규 시장 개척, 글로벌 매출 다변화.
- **강력한 현금흐름**: 연간 1,000억 달러 이상의 FCF, 공격적 자사주 매입 및 배당 지속 가능.
- **높은 수익성**: 영업이익률 30% 이상, 업계 내 독보적 경쟁력.

#### 2) 리스크 요인

- **매출 성장 정체**: 최근 3년간 매출 성장률 둔화, 하드웨어 시장 포화.
- **높은 부채비율**: 자기자본 대비 부채비율 500% 이상, 금리 상승 시 이자비용 부담 가능성.
- **중국 등 지정학적 리스크**: 글로벌 공급망 및 시장 의존도.
- **혁신성 저하 우려**: 신제품 혁신성에 대한 시장 기대치 하락 시 밸류에이션 부담.

---

### 4. 결론 및 투자 의견

Apple은 압도적인 현금 창출력, 높은 수익성, 서비스 부문 성장, 글로벌 시장 다변화 전략을 바탕으로 여전히 견고한 펀더멘털을 보유하고 있습니다.
다만, 매출 성장 정체와 높은 부채비율, 하드웨어 시장 포화 등은 중장기적으로 주가 상승의 제약 요인으로 작용할 수 있습니다.

**종합적으로 볼 때, Apple은 안정적 현금흐름과 주주환원 정책, 서비스 부문 성장에 힘입어 중장기적으로 매력적인 투자처로 평가됩니다.**
단, 단기적으로는 성장 모멘텀 둔화와 부채 구조에 대한 모니터링이 필요합니다.

**투자 의견: "비중 유지(Neutral to Overweight)"**

- 장기 투자자에게는 여전히 우량주로서의 매력이 높으나, 추가 매수는 서비스 부문 성장 가시화 및 신흥시장 성과 확인 후가 바람직합니다.
- 단기적으로는 실적 성장률과 부채 관리, 신제품 혁신성에 대한 시장 반응을 주시해야 합니다.

---

# **(본 보고서는 2024년 9월 결산 기준 객관적 재무 데이터와 최신 사업 동향에 기반한 분석 결과입니다.)**
